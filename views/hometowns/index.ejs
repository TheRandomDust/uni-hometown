<% layout('layouts/boilerplate') %>

	<div id="map" style="width: 100%; height: 500px"></div>
	<h1>All Hometowns</h1>

	<% for (let hometown of hometowns) { %>
		<div class="card mb-5">
			<div class="row">
				<div class="col-md-4">
					<% if (hometown.images.length) { %>
						<img src="<%= hometown.images[0].url %>" alt="" class="img-fluid">
					<% } else { %>
						<img src="" alt=""> <!-- TODO later have a default image -->
					<% } %>
				</div>
				<div class="col-md-8">
					<h5 class="card-title mt-5">
						<%= hometown.town %>
					</h5>
					<p class="card-text">
						<%= hometown.description %>
					</p>
					<p class="card-text"><small class="text-muted">
							<%= hometown.extraCoolThings %> - <%= hometown.milesFromUni %> miles from University
						</small></p>
					<a href="hometowns/<%= hometown._id %>" class="btn btn-dark">View <%= hometown.town %></a>
				</div>
			</div>
		</div>
	<% } %>
	<script>
		const mapToken = '<%- process.env.MAPBOX_TOKEN %>';	
		const hometowns = { features: JSON.parse('<%- JSON.stringify(hometowns) %>') };
		console.log(hometowns);
	</script>
	<script src="/scripts/clusterMap.js"></script>